{"version":3,"sources":["D2App/App.module.css","D2App/components/MenuManagement/DraggableApp.module.css","D2App/components/MenuManagement/MenuManagement.module.css","D2App/locales/index.js","D2App/components/MenuManagement/DraggableApp.js","D2App/components/MenuManagement/index.js","D2App/App.js"],"names":["module","exports","namespace","i18n","addResources","arTranslations","csTranslations","enTranslations","esTranslations","frTranslations","nbTranslations","svTranslations","ukTranslations","urTranslations","uzTranslations","uz_LatnTranslations","viTranslations","zhTranslations","App","defaultAction","icon","displayName","React","createElement","className","classes","href","src","DraggableApp","app","onDrag","onDrop","isDragging","connectDrag","useDrag","item","name","type","collect","monitor","end","connectDrop","useDrop","accept","hover","ref","useRef","style","visibility","query","apps","resource","mutation","data","items","MenuManagement","initialAppsOrder","appsOrder","setAppsOrder","useState","show","showSuccessfulUpdateAlert","useAlert","t","success","showErrorUpdatingAlert","message","critical","mutate","useDataMutation","onComplete","onError","error","handleAppDrag","useCallback","target","newAppsOrder","appIndex","indexOf","targetIndex","newApps","splice","moveApp","handleAppDrop","Card","DndProvider","backend","HTML5Backend","map","appName","key","MenuManagementWrapper","baseUrl","useConfig","loading","useDataQuery","useMemo","getPath","path","startsWith","parts","filter","part","replace","join","joinPath","modules","CenteredContent","CircularLoader","msg","NoticeBox","title","appsByName","forEach","Fragment","CssVariables","spacers","theme","container","description"],"mappings":"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","file":"static/js/app.ce1879e1.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"App_container__2zgzu\",\"title\":\"App_title__1NBlr\",\"description\":\"App_description__3qOuV\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"app-link\":\"DraggableApp_app-link__1sukN\",\"app-icon\":\"DraggableApp_app-icon__2JFke\",\"app-name\":\"DraggableApp_app-name__2jau-\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"apps\":\"MenuManagement_apps__23px2\"};","//------------------------------------------------------------------------------\n// <auto-generated>\n// This code was generated by d2-i18n-generate.\n//\n// Changes to this file may cause incorrect behavior and will be lost if\n// the code is regenerated.\n// </auto-generated>\n//------------------------------------------------------------------------------\nimport i18n from '@dhis2/d2-i18n';\nimport arTranslations from './ar/translations.json';\nimport csTranslations from './cs/translations.json';\nimport enTranslations from './en/translations.json';\nimport esTranslations from './es/translations.json';\nimport frTranslations from './fr/translations.json';\nimport nbTranslations from './nb/translations.json';\nimport svTranslations from './sv/translations.json';\nimport ukTranslations from './uk/translations.json';\nimport urTranslations from './ur/translations.json';\nimport uzTranslations from './uz/translations.json';\nimport uz_LatnTranslations from './uz_Latn/translations.json';\nimport viTranslations from './vi/translations.json';\nimport zhTranslations from './zh/translations.json';\nconst namespace = 'default';\ni18n.addResources('ar', namespace, arTranslations);\ni18n.addResources('cs', namespace, csTranslations);\ni18n.addResources('en', namespace, enTranslations);\ni18n.addResources('es', namespace, esTranslations);\ni18n.addResources('fr', namespace, frTranslations);\ni18n.addResources('nb', namespace, nbTranslations);\ni18n.addResources('sv', namespace, svTranslations);\ni18n.addResources('uk', namespace, ukTranslations);\ni18n.addResources('ur', namespace, urTranslations);\ni18n.addResources('uz', namespace, uzTranslations);\ni18n.addResources('uz_Latn', namespace, uz_LatnTranslations);\ni18n.addResources('vi', namespace, viTranslations);\ni18n.addResources('zh', namespace, zhTranslations);\nexport default i18n;","import { PropTypes } from '@dhis2/prop-types';\nimport React, { useRef } from 'react';\nimport { useDrag, useDrop } from 'react-dnd';\nimport classes from './DraggableApp.module.css';\n\nconst App = ({\n  defaultAction,\n  icon,\n  displayName\n}) => /*#__PURE__*/React.createElement(\"div\", null, /*#__PURE__*/React.createElement(\"a\", {\n  className: classes['app-link'],\n  href: defaultAction\n}, /*#__PURE__*/React.createElement(\"img\", {\n  className: classes['app-icon'],\n  src: icon\n}), /*#__PURE__*/React.createElement(\"div\", {\n  className: classes['app-name']\n}, displayName)));\n\nApp.propTypes = {\n  defaultAction: PropTypes.string.isRequired,\n  displayName: PropTypes.string.isRequired,\n  icon: PropTypes.string.isRequired\n};\nconst DND_ITEM_TYPE = 'APP';\n\nconst DraggableApp = ({\n  app,\n  onDrag,\n  onDrop\n}) => {\n  const [{\n    isDragging\n  }, connectDrag] = useDrag({\n    item: {\n      name: app.name,\n      type: DND_ITEM_TYPE\n    },\n    collect: monitor => ({\n      isDragging: monitor.isDragging()\n    }),\n    end: onDrop\n  });\n  const [, connectDrop] = useDrop({\n    accept: DND_ITEM_TYPE,\n\n    hover(item) {\n      if (item.name != app.name) {\n        onDrag(item.name, app.name);\n      }\n    }\n\n  });\n  const ref = useRef();\n  connectDrag(ref);\n  connectDrop(ref);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    ref: ref,\n    style: {\n      visibility: isDragging ? 'hidden' : 'visible'\n    }\n  }, /*#__PURE__*/React.createElement(App, app));\n};\n\nDraggableApp.propTypes = {\n  app: PropTypes.any.isRequired,\n  onDrag: PropTypes.func.isRequired,\n  onDrop: PropTypes.func.isRequired\n};\nexport default DraggableApp;","import { useDataQuery, useDataMutation, useConfig, useAlert } from '@dhis2/app-runtime';\nimport { PropTypes } from '@dhis2/prop-types';\nimport { NoticeBox, CenteredContent, CircularLoader, Card } from '@dhis2/ui';\nimport React, { useMemo, useState, useCallback } from 'react';\nimport { DndProvider } from 'react-dnd';\nimport { HTML5Backend } from 'react-dnd-html5-backend';\nimport i18n from '../../locales/index.js';\nimport DraggableApp from './DraggableApp.js';\nimport classes from './MenuManagement.module.css';\nconst query = {\n  apps: {\n    resource: 'action::menu/getModules'\n  }\n};\nconst mutation = {\n  resource: 'menu',\n  type: 'create',\n  data: ({\n    items\n  }) => items\n};\n\nconst moveApp = (apps, app, target) => {\n  const appIndex = apps.indexOf(app);\n  const targetIndex = apps.indexOf(target);\n  const newApps = [...apps];\n  newApps.splice(appIndex, 1);\n  newApps.splice(targetIndex, 0, app);\n  return newApps;\n};\n\nconst MenuManagement = ({\n  apps,\n  initialAppsOrder\n}) => {\n  const [appsOrder, setAppsOrder] = useState(initialAppsOrder);\n  const {\n    show: showSuccessfulUpdateAlert\n  } = useAlert(i18n.t('Updated order of apps.'), {\n    success: true\n  });\n  const {\n    show: showErrorUpdatingAlert\n  } = useAlert(message => message, {\n    critical: true\n  });\n  const [mutate] = useDataMutation(mutation, {\n    onComplete() {\n      showSuccessfulUpdateAlert();\n    },\n\n    onError(error) {\n      showErrorUpdatingAlert(error.message);\n    }\n\n  });\n  const handleAppDrag = useCallback((app, target) => {\n    const newAppsOrder = moveApp(appsOrder, app, target);\n    setAppsOrder(newAppsOrder);\n  }, [appsOrder]);\n  const handleAppDrop = useCallback(() => {\n    mutate({\n      items: appsOrder\n    });\n  }, [appsOrder]);\n  return /*#__PURE__*/React.createElement(Card, null, /*#__PURE__*/React.createElement(DndProvider, {\n    backend: HTML5Backend\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.apps\n  }, appsOrder.map(appName => /*#__PURE__*/React.createElement(DraggableApp, {\n    key: appName,\n    onDrag: handleAppDrag,\n    onDrop: handleAppDrop,\n    app: apps[appName]\n  })))));\n};\n\nMenuManagement.propTypes = {\n  apps: PropTypes.object.isRequired,\n  initialAppsOrder: PropTypes.array.isRequired\n};\n\nconst joinPath = (...parts) => {\n  const realParts = parts.filter(part => !!part);\n  return realParts.map(part => part.replace(/^\\/+|\\/+$/g, '')).join('/');\n};\n\nconst MenuManagementWrapper = () => {\n  const {\n    baseUrl\n  } = useConfig();\n  const {\n    loading,\n    error,\n    data\n  } = useDataQuery(query);\n  const apps = useMemo(() => {\n    const getPath = path => path.startsWith('http:') || path.startsWith('https:') ? path : joinPath(baseUrl, 'api', path);\n\n    return data === null || data === void 0 ? void 0 : data.apps.modules.map(app => ({ ...app,\n      icon: getPath(app.icon),\n      defaultAction: getPath(app.defaultAction)\n    }));\n  }, [data]);\n\n  if (loading) {\n    return /*#__PURE__*/React.createElement(CenteredContent, null, /*#__PURE__*/React.createElement(CircularLoader, null));\n  }\n\n  if (error) {\n    const msg = i18n.t('Something went wrong whilst loading your apps');\n    return /*#__PURE__*/React.createElement(NoticeBox, {\n      error: true,\n      title: msg\n    }, error.message);\n  }\n\n  const appsByName = {};\n  apps.forEach(app => appsByName[app.name] = app);\n  return /*#__PURE__*/React.createElement(MenuManagement, {\n    apps: appsByName,\n    initialAppsOrder: apps.map(({\n      name\n    }) => name)\n  });\n};\n\nexport default MenuManagementWrapper;","import { CssVariables } from '@dhis2/ui';\nimport React from 'react';\nimport classes from './App.module.css';\nimport MenuManagement from './components/MenuManagement/index.js';\nimport i18n from './locales/index.js';\n\nconst App = () => /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(CssVariables, {\n  spacers: true,\n  theme: true\n}), /*#__PURE__*/React.createElement(\"div\", {\n  className: classes.container\n}, /*#__PURE__*/React.createElement(\"header\", null, /*#__PURE__*/React.createElement(\"h1\", {\n  className: classes.title\n}, i18n.t('Your apps')), /*#__PURE__*/React.createElement(\"p\", {\n  className: classes.description\n}, i18n.t('Drag and drop the menu items to re-order them.'))), /*#__PURE__*/React.createElement(MenuManagement, null)));\n\nexport default App;"],"sourceRoot":""}